<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quill 2.0.3 - Hierarchical List Demo</title>
    <link href="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.snow.css" rel="stylesheet">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }

        #editor {
            height: 450px;
        }

        .ql-editor li[data-list="checked"]::before {
            background: #000;
        }

        /* Custom toolbar button for hierarchical list */
        .ql-snow .ql-picker.ql-list-hierarchical,
        .ql-snow .ql-picker-label.ql-list-hierarchical,
        .ql-snow button.ql-list-hierarchical {
            width: auto;
        }

        .ql-snow button.ql-list-hierarchical .ql-stroke {
            stroke: currentColor;
        }

        .ql-snow button.ql-list-hierarchical .ql-fill {
            fill: currentColor;
        }

        /* Hierarchical list numbering using CSS counters */
        .ql-editor li[data-list="hierarchical"] {
            counter-increment: hierarchical-0;
            counter-reset: hierarchical-1 hierarchical-2 hierarchical-3 hierarchical-4 hierarchical-5 hierarchical-6 hierarchical-7 hierarchical-8 hierarchical-9;
        }
        
        .ql-editor li[data-list="hierarchical"].ql-indent-1 {
            counter-increment: hierarchical-1;
            counter-reset: hierarchical-2 hierarchical-3 hierarchical-4 hierarchical-5 hierarchical-6 hierarchical-7 hierarchical-8 hierarchical-9;
        }
        
        .ql-editor li[data-list="hierarchical"].ql-indent-2 {
            counter-increment: hierarchical-2;
            counter-reset: hierarchical-3 hierarchical-4 hierarchical-5 hierarchical-6 hierarchical-7 hierarchical-8 hierarchical-9;
        }
        
        .ql-editor li[data-list="hierarchical"].ql-indent-3 {
            counter-increment: hierarchical-3;
            counter-reset: hierarchical-4 hierarchical-5 hierarchical-6 hierarchical-7 hierarchical-8 hierarchical-9;
        }
        
        .ql-editor li[data-list="hierarchical"].ql-indent-4 {
            counter-increment: hierarchical-4;
            counter-reset: hierarchical-5 hierarchical-6 hierarchical-7 hierarchical-8 hierarchical-9;
        }
        
        .ql-editor li[data-list="hierarchical"].ql-indent-5 {
            counter-increment: hierarchical-5;
            counter-reset: hierarchical-6 hierarchical-7 hierarchical-8 hierarchical-9;
        }
        
        .ql-editor li[data-list="hierarchical"].ql-indent-6 {
            counter-increment: hierarchical-6;
            counter-reset: hierarchical-7 hierarchical-8 hierarchical-9;
        }
        
        .ql-editor li[data-list="hierarchical"].ql-indent-7 {
            counter-increment: hierarchical-7;
            counter-reset: hierarchical-8 hierarchical-9;
        }
        
        .ql-editor li[data-list="hierarchical"].ql-indent-8 {
            counter-increment: hierarchical-8;
            counter-reset: hierarchical-9;
        }
        
        .ql-editor li[data-list="hierarchical"].ql-indent-9 {
            counter-increment: hierarchical-9;
        }

        /* Level 0: 1. 2. 3. */
        .ql-editor li[data-list="hierarchical"]:not([class*="ql-indent-"])::before {
            content: counter(hierarchical-0) ". ";
        }

        /* Level 1: 1.1 1.2 2.1 */
        .ql-editor li[data-list="hierarchical"].ql-indent-1::before {
            content: counter(hierarchical-0) "." counter(hierarchical-1) " ";
        }

        /* Level 2: 1.1.1 1.1.2 */
        .ql-editor li[data-list="hierarchical"].ql-indent-2::before {
            content: counter(hierarchical-0) "." counter(hierarchical-1) "." counter(hierarchical-2) " ";
        }

        /* Level 3: 1.1.1.1 */
        .ql-editor li[data-list="hierarchical"].ql-indent-3::before {
            content: counter(hierarchical-0) "." counter(hierarchical-1) "." counter(hierarchical-2) "." counter(hierarchical-3) " ";
        }

        /* Level 4: 1.1.1.1.1 */
        .ql-editor li[data-list="hierarchical"].ql-indent-4::before {
            content: counter(hierarchical-0) "." counter(hierarchical-1) "." counter(hierarchical-2) "." counter(hierarchical-3) "." counter(hierarchical-4) " ";
        }

        /* Level 5: 1.1.1.1.1.1 */
        .ql-editor li[data-list="hierarchical"].ql-indent-5::before {
            content: counter(hierarchical-0) "." counter(hierarchical-1) "." counter(hierarchical-2) "." counter(hierarchical-3) "." counter(hierarchical-4) "." counter(hierarchical-5) " ";
        }

        /* Level 6 */
        .ql-editor li[data-list="hierarchical"].ql-indent-6::before {
            content: counter(hierarchical-0) "." counter(hierarchical-1) "." counter(hierarchical-2) "." counter(hierarchical-3) "." counter(hierarchical-4) "." counter(hierarchical-5) "." counter(hierarchical-6) " ";
        }

        /* Level 7 */
        .ql-editor li[data-list="hierarchical"].ql-indent-7::before {
            content: counter(hierarchical-0) "." counter(hierarchical-1) "." counter(hierarchical-2) "." counter(hierarchical-3) "." counter(hierarchical-4) "." counter(hierarchical-5) "." counter(hierarchical-6) "." counter(hierarchical-7) " ";
        }

        /* Level 8 */
        .ql-editor li[data-list="hierarchical"].ql-indent-8::before {
            content: counter(hierarchical-0) "." counter(hierarchical-1) "." counter(hierarchical-2) "." counter(hierarchical-3) "." counter(hierarchical-4) "." counter(hierarchical-5) "." counter(hierarchical-6) "." counter(hierarchical-7) "." counter(hierarchical-8) " ";
        }

        /* Level 9 */
        .ql-editor li[data-list="hierarchical"].ql-indent-9::before {
            content: counter(hierarchical-0) "." counter(hierarchical-1) "." counter(hierarchical-2) "." counter(hierarchical-3) "." counter(hierarchical-4) "." counter(hierarchical-5) "." counter(hierarchical-6) "." counter(hierarchical-7) "." counter(hierarchical-8) "." counter(hierarchical-9) " ";
        }
    </style>
</head>

<body>
    <h1>Quill 2.0.3 - Hierarchical List Demo</h1>
    <p><strong>Usage:</strong></p>
    <ul>
        <li>Click the <strong>hierarchical list icon</strong> (☰ with numbers) to create a hierarchical list</li>
        <li>Or click "1." button for standard ordered list, then use Tab to indent</li>
        <li>Select a list item and press <strong>Tab</strong> to indent (nested level)</li>
        <li>Press <strong>Shift+Tab</strong> to outdent</li>
        <li>The numbering will update automatically: 1 → 1.1 → 1.1.1</li>
    </ul>
    <div id="editor"></div>

    <script src="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.js"></script>
    <script>
        // Extend Quill's ListItem to support hierarchical lists
        const ListItem = Quill.import('formats/list');

        // Create hierarchical list item
        class HierarchicalListItem extends ListItem {
            static create(value) {
                const node = super.create(value);
                node.setAttribute('data-list', value);
                return node;
            }

            static formats(domNode) {
                return domNode.getAttribute('data-list') || undefined;
            }
        }
        HierarchicalListItem.blotName = 'hierarchical';
        HierarchicalListItem.tagName = 'LI';

        // Create hierarchical list container
        const ListContainer = Quill.import('formats/list-container');
        class HierarchicalListContainer extends ListContainer {}
        HierarchicalListContainer.blotName = 'hierarchical-list-container';
        HierarchicalListContainer.tagName = 'OL';
        HierarchicalListContainer.allowedChildren = [HierarchicalListItem];
        HierarchicalListItem.requiredContainer = HierarchicalListContainer;

        // Register the new formats
        Quill.register(HierarchicalListContainer);
        Quill.register(HierarchicalListItem);

        // Register custom SVG icon for hierarchical list
        const icons = Quill.import('ui/icons');

        // Register with both possible key formats
        icons['list']['hierarchical'] = `<svg viewBox="0 0 18 18">
            <line class="ql-stroke" x1="3" y1="4" x2="15" y2="4"></line>
            <line class="ql-stroke" x1="3" y1="9" x2="15" y2="9"></line>
            <line class="ql-stroke" x1="3" y1="14" x2="15" y2="14"></line>
            <line class="ql-stroke" x1="7" y1="3" x2="7" y2="5"></line>
            <line class="ql-stroke" x1="11" y1="3" x2="11" y2="5"></line>
            <line class="ql-stroke" x1="7" y1="8" x2="7" y2="10"></line>
            <line class="ql-stroke" x1="11" y1="8" x2="11" y2="10"></line>
            <line class="ql-stroke" x1="7" y1="13" x2="7" y2="15"></line>
            <line class="ql-stroke" x1="11" y1="13" x2="11" y2="15"></line>
        </svg>`;

        // Initialize Quill editor
        const quill = new Quill('#editor', {
            theme: 'snow',
            modules: {
                toolbar: {
                    container: [
                        [{header: [1, 2, 3, false]}],
                        ['bold', 'italic', 'underline', 'strike'],
                        [{color: []}, {background: []}],
                        [{list: 'ordered'}, {list: 'bullet'}, {list: 'hierarchical'}, {indent: '-1'}, {indent: '+1'}],
                        ['link', 'image'],
                        ['clean']
                    ],
                }
            }
        });
    </script>
</body>

</html>
